# AI ผู้ช่วยจัดทำรายงานภาษาไทย

เว็บแอปขนาดเล็กสำหรับช่วยจัดโครงรายงานภาษาไทยแบบมาตรฐาน โดยสามารถ:

- เลือกองค์ประกอบรายงาน (หน้าปก คำนำ บทคัดย่อ สารบัญ บทที่ 1-5 สรุปข้อดีข้อเสีย ฯลฯ)
- กำหนดย่อหน้าและระยะบรรทัด
- ระบุชื่อโรงเรียน/สถาบัน และข้อมูลรายวิชาหลักของรายงาน
- สร้างโครงรายงานอัตโนมัติ
- แบ่งหน้าเอกสารเป็นขนาด A4 อัตโนมัติ (แยกแต่ละองค์ประกอบคนละหน้า)
- หน้าปกและสารบัญจัดวางแบบทางการสำหรับรายงานนักเรียน พร้อมข้อมูลชั้น/รายวิชา/ครูผู้สอน
- แสดงเลขหน้าที่หัวกระดาษด้านขวาบน (ยกเว้นหน้าปก)
- เพิ่มภาพประกอบแต่ละหัวข้ออัตโนมัติให้ดูเป็นรายงานมากขึ้น
- สารบัญแบบปรับดีไซน์ใหม่ อ่านง่ายและดูเป็นทางการ
- เปิดโหมดแก้ไขเพื่อปรับข้อความรายงานได้ก่อนบันทึก
- ดาวน์โหลดเป็นไฟล์ PDF (ล็อกสเกลและขนาดหน้า A4 เพื่อไม่ให้เพี้ยนเมื่อส่งออก)
- ดาวน์โหลดเป็นไฟล์ PDF ผ่านเซิร์ฟเวอร์คุณภาพสูง (PrinceXML หรือ Playwright)

## วิธีใช้งาน

1. เปิดไฟล์ `index.html` ในเบราว์เซอร์
2. กรอกข้อมูลรายงาน
3. เลือกส่วนประกอบที่ต้องการ
4. กด **จัดโครงรายงานด้วย AI**
5. (ตัวเลือก) กด **เปิดโหมดแก้ไข** เพื่อแก้ข้อความในรายงาน
6. กด **ดาวน์โหลดเป็น PDF**

> หมายเหตุ: หากต้องการการแสดงผลฟอนต์ไทยสวยงาม ควรเชื่อมต่ออินเทอร์เน็ตเพื่อโหลดฟอนต์ Sarabun จาก Google Fonts

## การใช้งาน PDF คุณภาพสูง (ทางเลือก)

### ตัวเลือกที่ 1: PrinceXML (แนะนำสำหรับคุณภาพสูงสุด)

1. ติดตั้ง PrinceXML บนเครื่องหรือเซิร์ฟเวอร์ที่รัน backend
2. ติดตั้ง dependency: `npm install --omit=dev`
3. รันเซิร์ฟเวอร์: `npm run start`
4. เปิดหน้าเว็บผ่าน `http://localhost:3000` แล้วกด **ดาวน์โหลดเป็น PDF (คุณภาพสูง: PrinceXML)**

### ตัวเลือกที่ 2: Playwright (ทางเลือกฟรี)

1. ติดตั้ง dependency: `npm install --omit=dev`
2. ติดตั้งเบราว์เซอร์: `npx playwright install --with-deps`
3. รันเซิร์ฟเวอร์: `npm run start`
4. เปิดหน้าเว็บผ่าน `http://localhost:3000` แล้วกด **ดาวน์โหลดเป็น PDF (คุณภาพสูง: Playwright)**

### สคริปต์ติดตั้งแบบวนซ้ำจนกว่าจะสำเร็จ

หากเครือข่ายไม่เสถียร สามารถสั่งติดตั้งแบบวนซ้ำจนกว่าจะสำเร็จได้:

```bash
npm run install:pdf-engine
```

> ตั้งค่า `MAX_RETRIES=5` เพื่อจำกัดจำนวนครั้งที่ลอง (ค่าเริ่มต้นคือวนซ้ำไม่จำกัด)

> หากระบบยังไม่พบ PrinceXML หรือ Playwright ปุ่มดาวน์โหลดคุณภาพสูงจะถูกปิดพร้อมข้อความแจ้งเตือนอัตโนมัติ
